<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Title</title>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>
<body>



<button onclick="BiLogin()">登录bi</button>
<button onclick="BpmLogin()">bpm登录</button>
<button onclick="CrmLogin()">crm登录</button>
<script>

    function BiLogin() {
        $.ajax({
            type: "get",    //请求方式
            async: false,    //是否异步
            url: url,
            dataType: "jsonp",    //跨域json请求一定是jsonp
            jsonp: "callback",    //跨域请求的参数名，默认是callback
            //jsonpCallback:"successCallback",    //自定义跨域参数值，回调函数名也是一样，默认为jQuery自动生成的字符串
            // data: {"query": "civilnews"},    //请求参数
            success: function (data) {
                window.open("http://bpmtest.nabeluse.com");
            },
            error: function (res) {
                window.open("http://bpmtest.nabeluse.com");
            }
        });

    }

    function BpmLogin() {
        var date = new Date();
        var url = "http://bpmtest.nabeluse.com/YZSoft/login/ajax_admin.ashx?do_login=true&action=login&posid=0&lis=" + date + "&uid=test&pwd=test&vercode=";

        $.ajax({
            type: "get",    //请求方式
            async: false,    //是否异步
            url: url,
            dataType: "jsonp",    //跨域json请求一定是jsonp
            jsonp: "callback",    //跨域请求的参数名，默认是callback
            //jsonpCallback:"successCallback",    //自定义跨域参数值，回调函数名也是一样，默认为jQuery自动生成的字符串
            // data: {"query": "civilnews"},    //请求参数
            success: function (data) {
                window.open("http://bpmtest.nabeluse.com");
            },
            error: function (res) {
                getBpmCokie(url);
            }
        });
    }


    function getBpmCokie(url) {

        $.ajax({
            type: "get",    //请求方式
            async: false,    //是否异步
            url: url,
            dataType: "jsonp",    //跨域json请求一定是jsonp
            jsonp: "callback",    //跨域请求的参数名，默认是callback
            //jsonpCallback:"successCallback",    //自定义跨域参数值，回调函数名也是一样，默认为jQuery自动生成的字符串
            // data: {"query": "civilnews"},    //请求参数
            success: function (data) {
                window.open("http://bpmtest.nabeluse.com");
            },
            error: function (res) {
                window.open("http://bpmtest.nabeluse.com");
            }
        });
    }
    
    function CrmLogin() {
        // $.ajax({
        //     type: "GET",
        //     url: "http://wxtestbusiness.nabeluse.com:5555",
        //     contentType: "text/xml",
        //     // dataType: "xml",
        //     dataType: "jsonp",    //跨域json请求一定是jsonp
        //     jsonp: "callback",
        //     data: "soapRequest",
        //     username: 'test123@ad',
        //     password: 'test123',
        //     xhrFields: {
        //         withCredentials: true
        //     },
        //     success: function (res) {
        //         console.info("res",res);
        //         window.open("http://wxtestbusiness.nabeluse.com:5555");
        //     },
        //     error: function () {
        //
        //     }
        // });


        // var xhttp = new XMLHttpRequest();
        var xhttp=getHttpObj();
        xhttp.open("GET", "http://wxtestbusiness.nabeluse.com:5555", true,"test123@ad","test123");
        xhttp.setRequestHeader("X-Requested-With", "XMLHttpRequest");
        xhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;");//缺少这句，后台无法获取参数
        xhttp.withCredentials = true;
        xhttp.send();
        xhttp.onreadystatechange = function(){
            if (xhttp.readyState == XMLHttpRequest.DONE) {
                if (xhttp.status == 200){
                    // doSomething(xhttp.responseText);
                    window.open("http://wxtestbusiness.nabeluse.com:5555");

                } else{
                    console.log('There was a problem with the request.');
                }
            }
        };


    }

    function getHttpObj() {
        var httpobj = null;
        try {
            httpobj = new ActiveXObject("Msxml2.XMLHTTP");
        }
        catch (e) {
            try {
                httpobj = new ActiveXObject("Microsoft.XMLHTTP");
            }
            catch (e1) {
                httpobj = new XMLHttpRequest();
            }
        }
        return httpobj;
    }


</script>

</body>
</html>